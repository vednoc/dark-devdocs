/* ==UserStyle==
@name         Dark DevDocs
@description  A customizable theme for DevDocs.
@namespace    github.com/vednoc/dark-devdocs
@author       vednoc
@version      0.1.0
@homepageURL  https://github.com/vednoc/dark-devdocs
@supportURL   https://github.com/vednoc/dark-devdocs/issues
@updateURL    https://gitlab.com/vednoc/dark-devdocs/raw/master/dd.user.styl
@preprocessor stylus

@var text b_radius "Custom border radius" 4px
@var text ui_font "Custom UI font" "'custom_font', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', Arial, sans-serif"
@var text mono_font "Custom Mono font" "'custom_font', 'SFMono-Regular', 'Consolas', 'Liberation Mono', Menlo, Courier, monospace"
@var text mono_size "Custom Mono font size" 1em
@var text max_width "Max width for content" 100%

@var color dark    "Dark color.   " #222222
@var color darker  "Darker color. " #2f2f2f
@var color light   "Light color.  " #d1d1d1
@var color lighter "Lighter color." #c9c9c9
@var color icon    "Icon color.   " #e1e1e1
@var color accent  "Accent color. " #7289da
@var color yellow  "Yellow color. " #f0c674
@var color orange  "Orange color. " #de935f
@var color red     "Red color.    " #a54242
@var color magenta "Magenta color." #b294bb
@var color violet  "Violet color. " #85678f
@var color blue    "Blue color.   " #5f819d
@var color cyan    "Cyan color.   " #5e8d87
@var color green   "Green color.  " #8c9440
@var color white   "White color.  " #ffffff
@var color shadow  "Shadow color. " #00000020

==/UserStyle== */

@-moz-document domain('devdocs.io') {

    :root {
        --dark    : dark;
        --darker  : darker;
        --light   : light;
        --lighter : lighter;
        --accent  : accent;
        --shadow  : shadow;
        --yellow  : yellow;
        --orange  : orange;
        --red     : red;
        --magenta : magenta;
        --violet  : violet;
        --blue    : blue;
        --cyan    : cyan;
        --green   : green;
        --white   : white;
        --t       : transparent;

        --width     : max_width;
        --radius    : b_radius;
        --ui-font   : ui_font;
        --mono-font : mono_font;
        --mono-size : mono_size;
    }

    // * Use stylus-lang variables with CSS variables.
    $dark    = var(--dark);
    $darker  = var(--darker);
    $light   = var(--light);
    $lighter = var(--lighter);
    $accent  = var(--accent);
    $shadow  = var(--shadow);
    $yellow  = var(--yellow);
    $orange  = var(--orange);
    $red     = var(--red);
    $magenta = var(--magenta);
    $violet  = var(--violet);
    $blue    = var(--blue);
    $cyan    = var(--cyan);
    $green   = var(--green);
    $white   = var(--white);
    $t       = var(--t);
    $r       = var(--radius);

    // * Mixins.
    radius() { border-radius: arguments }
    c(x, y = 0, z = 0, xi = 1, yi = 1, zi = 1) {
        if x is a 'call' {            color: xi is 0 ? x : x !important }
        if y is a 'call' {     border-color: yi is 0 ? y : y !important }
        if z is a 'call' { background-color: zi is 0 ? z : z !important }
    }

    // * Reset.
    body {
        c: $lighter 0 $dark;

        // * Feature -> Custom UI font.
        font-family: var(--ui-font);

        table {
            radius: $r !important;
            c: 0 $darker $dark;
            thead {
                tr th {
                    c: $light $darker $darker;
                    ../ tr:first-child > th:first-child {
                        radius: calc(var(--radius) - 2px) 0 0 0;
                    }
                    ../ tr:first-child > th:last-child {
                        radius: 0 calc(var(--radius) - 2px) 0 0;
                    }
                }
            }
            tbody {
                tr th {
                    c: $light $darker $darker;
                    ../ tr:first-child > th:first-child {
                        radius: calc(var(--radius) - 2px) 0 0 0;
                    }
                    ../ tr:first-child > th:last-child {
                        radius: 0 calc(var(--radius) - 2px) 0 0;
                    }
                }
                tr td { c: $lighter $darker $t }
                code { c: $light 0 $darker }
                a { c: $accent }
            }
        }

        pre {
            radius: $r;
            c: $light $darker $dark;
            box-shadow: 0 2px 4px 0 $shadow;

            // * Feature -> Custom Mono font.
            &, ../ code, samp { font-family: var(--mono-font) }

            // * Feature -> Custom font size.
            &, ../ code, samp { font-size: var(--mono-size) }

            &[data-language] {
                font-size: var(--mono-size);
                .comment, .punctuation { c: $lighter }
                .function { c: $red }
                .number { c: $violet }
                .operator, .entity, .url { c: $yellow }
                .atrule, .attr-value, .keyword { c: $blue }
                .property, .tag, .boolean, .constant, .symbol, .deleted { c: $orange }
                .selector, .attr-name, .string, .char, .builtin, .inserted { c: $green }
            }

            // Clipboard button.
            ._pre-clip {
                opacity: 0;
                display: block;
                transition: 0.15s ease;
                &::before { c: $light }
                > svg { fill: $light }
                ../:hover ._pre-clip { opacity: 0.5 }
            }
        }

        // * Sidebar -> Overflowing list item.
        ._list-item.clone {
            c: $light 0 $darker;
            box-shadow: none;
        }

        // Main -> Landing page.
        ._intro {
            &-message {
                radius: $r;
                c: $light $darker $dark;
                box-shadow: 0 2px 4px 0 $shadow;
                a[href] { c: $accent }
            }
            iframe { filter: invert(1) hue-rotate(180deg) }
        }
    }

    // * Sidebar -> Search.
    ._header[role='banner'] {
        c: 0 $darker $dark;

        ._search {
            &-tag { c: $light 0 $darker }

            &-input {
                radius: $r;
                c: $light $darker $dark;
                box-shadow: 0 3px 2px inset $shadow;
                &:focus {
                    c: 0 $accent;
                    box-shadow: 0 0 1px $accent;
                }
            }
        }
    }

    // * Sidebar -> Core.
    ._sidebar[tabindex='-1'] {
        c: $lighter $green $dark;

        ._list {
            box-shadow: inset -1px 0 $darker;

            &-item {
                c: 0 0 $t;
                box-shadow: inset -1px 0 $darker;
                &:hover { c : 0 0 $darker }

                ../ .focus, ../ .active {
                    c: $light 0 $darker;
                    box-shadow: inset -1px 0 $darker;
                }

                ._list-arrow {
                    fill: $light;
                    ../.open ._list-arrow { opacity: 1 }
                }
            }
        }
    }


    // * Main -> Content.
    ._container[role='document'] {
        // * Feature -> Max width for content.
        > main._content > div {
            margin: 0 auto;
            max-width: var(--width);
        }

        // Links.
        a {
            &[href] {
                c: $accent 0 0 0;
                code {
                    &.inline { color: inherit !important }
                    // Reset code within links.
                    ../ > code {
                        font-size: 1em;
                        font-family: var(--ui-font);
                    }
                }
            }
            // External links.
            &[href^='http:'], &[href^='https:'] {
                &::after {
                    content: 'ðŸ”—';
                    width: unset;
                    height: unset;
                    font-size: 1em;
                    background: none;
                    margin: 0 0 0 2px;
                    display: inline-flex;
                }
            }
        }

        p {
            // Page links.
            &._links {
                ._links-link { c: $accent 0 $dark }
            }
        }

        h1 {
            code { c: $light }
            &::after { c: 0 0 $darker }
        }
    }


    // * Main -> Core.
    ._app[role='application'] {

        // Notice.
        ._notice {
            c: $lighter 0 $dark;
            box-shadow: 0 -1px 0 0 $darker;
            a[href] { c: $accent }
            code { c: $light }
        }

        // Breadcrumbs.
        ._path {
            c: 0 0 $dark;
            box-shadow: inset 0 1px $darker;
            span:last-child { c: $light }
            &-arrow { fill: $lighter }
            &-item { c: $lighter }
        }

        // Resize the sidebar.
        > ._resizer {
            top: 0;
            bottom: 0;
            width: 8px;
            margin-left: -8px;
            c: 0 0 $darker;
            opacity: 0;
        }

        // Credits.
        ._attribution {
            &-p {
                radius: $r;
                c: $light 0 $darker;
            }
            &-link { c: $accent }
        }
    }
}
